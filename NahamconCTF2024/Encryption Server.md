# Description
I read online it's bad to re-use the prime numbers in RSA. So, I made this server that randomly generates them for me.
# Attachments
Rsa_Encryption_Server.py
```
#!/usr/bin/python3

from secrets import randbits
from sympy import nextprime
import random

e = random.randint(500,1000)

def encrypt(inp):
        p = nextprime(randbits(1024))
        q = nextprime(randbits(1024))
        n = p * q
        c = [pow(ord(m), e, n) for m in inp]
        return [n, c]

def main():

        while True:
                print('Welcome to the Really Shotty Asymmetric (RSA) Encryption Server!')
                print('1: Encrypt a message')
                print('2: View the encrypted flag')
                print('3: Exit')

                inp = ''
                while (not ('1' in inp or '2' in inp or '3' in inp)):
                        inp = input('> ')

                if('3' in inp):
                        print('Goodbye!')
                        exit()

                elif('1' in inp):
                        plain = input('Enter a message, and the server will encrypt it with a random N!\n> ')
                        encrypted = encrypt(plain)

                elif('2' in inp):
                        data = open('flag.txt', 'r').read()
                        data = data.strip()
                        encrypted = encrypt(data)

                print('Your randomly chosen N:')
                print(f'> {encrypted[0]}')
                print('Your encrypted message:')
                print(f'> {encrypted[1]}')
                print('\n')

if(__name__ == '__main__'):
        main()
```
#
I noticed that e is limited to values between 500 and 1000. This might be a vulnerability since, to obtain the plaintext, we need e, n, and c. Since n and c are already provided by the server, we only need to find 
e. Given that e is within a relatively small range, we can create a solution by iterating through all possible values of e until we find a match.

# Solution
The 
```
n = 26006987368636437610485097993600690664399829678267459850012830492414172814693965252422611866210655981063958664431592333198137913121368819376453063295904736047263531890241286943357685461451299866196013853685371767293821194231624614190350292615009997119416302672693291295937867401185159048652278987396800361398180517198232376829374852028232979741314105863297987019663376106930738378067453759196980095833599749318416370910278716420367851401749720570605501203028887679793840789262240329149563832749264085026669791215483498158372883819259073862224050115333609417680241051392272791234268425904111301591659911968515061126897
c = 18013040217357763369221488177399796305572696273653161200442717112923151849145801331730851580078975476272460713453798926482089913569321579393489934807129553192601081620578767530669375056180418635861646653331191540010091341260423544325575074122517372297293462368153709380785233381667142703484913056769432341880972742827048478612132854187978446890975038578448737797793715819371534996707028040375781072704059734321769208565431136803251073429840998234439970504606853531974747644013964305008386599682226360264310599067089244359127966551083310379367322851818472683774851911603267421433759873027711598807817529974585847058169
e = 710
m = [18013040217357763369221488177399796305572696273653161200442717112923151849145801331730851580078975476272460713453798926482089913569321579393489934807129553192601081620578767530669375056180418635861646653331191540010091341260423544325575074122517372297293462368153709380785233381667142703484913056769432341880972742827048478612132854187978446890975038578448737797793715819371534996707028040375781072704059734321769208565431136803251073429840998234439970504606853531974747644013964305008386599682226360264310599067089244359127966551083310379367322851818472683774851911603267421433759873027711598807817529974585847058169, 5699702649582646907770004954953042521517704882500106213220908192650169458755831614066830777759140498504189307188720403998730122548148324245526517779668089317338233839959300840832318596065271676640045243603506956351920123097670245854420249066160303299008770687994730404311323742915514462351593110139497768497717383154289971199790201168931436121505329153173157050146122072461360755435742102567413094744892861525036854012285253198787142983744945074457316160673205136113310523935897963562193411171567993901562577876674821214669467696748206816288192643550389851525368539258890569753785586909413902597107678598322624947818, 2969104952225441248961464312723202200179588680598690050380165913886988358426369492263068161863612948492620553523502907779221447008597559347293668289744869701695121761652372298324986153918392789470221725886212517283502414585782455978265556321861920972185829223550145296379683536030081162745110670578234854816529208986655357403182439810947962973674537010392137726530108088226705580276910806923436905058715116360700582978044321037563704193539038671782519101430563739424102156724283704178962791607461055215309634939008056400836638537070208912325876364293535546921566373911472085005179566861730414716227813123256632276035, 19634100581830628076629790069410227796400580883113125637126543547584188237105750211857578984649725166543247735883010288893510917642192406540596999472954802364129960621425824177983870390576270113889824204540469605370942526472950472255061680682440193826414710414760056972839025914170341055316514460600449612361643872767883653926509964226351141743702926356675916895398077533849094758999582599953273023399809726935174730201796641799660595779614948156387827085719541187521029923572143998100160344612592838429206489412030838568282687718701855814244817142694940580278079422424275263462313634230231462710468413206817311827776, 12716919705165483859950057430913289847285845686600078598929499521513681879315969354617533368214714193045293315548558100867098225356776623985044155772158557238873574132556929776505597765374262921854680518246497132258231265382672770678864645432389907852002781833373252019985346443716814031299628782499275757385482503704837730264139174716652939176271867083255524345438608394849443767550359363875028248345877131397593734426578996921959250512331767749627498520348209975038238322977091206914821135335827179960969686946452735552087429161952123887163829757059639901334392791873677943488208339586842251512412111084862989123323, 4703871041660600240688970243340830190915665849517002250164762459352118404257330371144012659662142918458224491058895727536730535430070582897465976655609475274898679197784075046635155061624045310839629208823848275617741928707874968567272418762902222441180871198933320386070422633931098072496768014418809006719419394475464990501284897814232897752132283546359452376490419566002200461542831518882381918490638128531427564081238746670843040931663124416084515631668028607511715921774562344230875868836572835594795246385623345552093667582463733264769343567278780373315708221664857541446769209506615511498638788895140903495342, 17165271319874592353776117274400898334459202668488237238746496950245192460859821949706959194150855021191192078350528874914673800986992912982377693158623338615602762217669459658655019046267029739463086937848369506202015764726642228039310758974474484581036641026129850461844641894908684519961136571806516397480625885428342333414844969821236267301091321148938831524185970688146965802160373361825783164768826226673520098070751908835835144256997842310569636753326582131384479448743218867852698478984933196148257216485682210634511126874153026125924016391710852937553128156164152172862864476742362317713243669784832881859083, 12218583538503113657034098973571855732461960329702749965297304654734222504510394806579828882412314873153701987586609282587147128982721673321650949261444663564821618660293978266488635205372076827444131626156413302660067380166241765284079965511730525454361498279843583524355166585280022235284329611504962946991212589194534131402840476462837463767910514344957480070023452543690102438509917195575781013107968061518530975223731588027250874278013586832963094479773202983826013947759160386297161693293561062410383403237936997367392850761225807694256384646785581937791673911045651714027051227597631797564749630634988931090295, 2792824974795279736050779673246486868103742467669877986946317952208588227583458154501920094167129329186679713799038875908210733279041350665359395079209754064021940615225818143442368859256767244004905139744808639051277151679343811430041359509857243475851261297220271635374619903558301031418644429230654283537438175978116580691521831537948005689487349729535814082639386964055597917600913283821621831529958403348584918295759803344139062078264742596665829089412257004147411103168932529012846518403436933105608201810081243657741436637094152581479058599986743516933639538957576144321807028724090703475438659550584899716596, 12218583538503113657034098973571855732461960329702749965297304654734222504510394806579828882412314873153701987586609282587147128982721673321650949261444663564821618660293978266488635205372076827444131626156413302660067380166241765284079965511730525454361498279843583524355166585280022235284329611504962946991212589194534131402840476462837463767910514344957480070023452543690102438509917195575781013107968061518530975223731588027250874278013586832963094479773202983826013947759160386297161693293561062410383403237936997367392850761225807694256384646785581937791673911045651714027051227597631797564749630634988931090295, 7366399579574602440976732407505552370818088489041276411824284406675583668949023906514737576787809482570376589120972541108132007260671334754841428677974325066771837379251553176747428530042619071429669631786581226509847881367573647725600753246915695486683228343013323745796657528897714064997694881169287854865595040353389336793597555449161182601340636166940834435839773757007527549181296092215237935351837824719175322474660191854493616190856482616197580756633363279022419897550310233268165094874340189901815352270117575288724707603063010230083024137461593412614562033025568083772205732033334034140833948551426221702933, 12218583538503113657034098973571855732461960329702749965297304654734222504510394806579828882412314873153701987586609282587147128982721673321650949261444663564821618660293978266488635205372076827444131626156413302660067380166241765284079965511730525454361498279843583524355166585280022235284329611504962946991212589194534131402840476462837463767910514344957480070023452543690102438509917195575781013107968061518530975223731588027250874278013586832963094479773202983826013947759160386297161693293561062410383403237936997367392850761225807694256384646785581937791673911045651714027051227597631797564749630634988931090295, 8897969001063638635018944763731859165411244465727025371285870006840799326693028601705775424761511031674897644853172892608606444825012723960105437632940457842809484477668237148235887485988982522174196879240939861342308420411798764510546772559894508200823337682910670063740176451121125684934871161848132835936385654898700142244190379381173393062207935886040960444308768005478021244017065245937916228536231607826123701542635290564853819021741427615115987716533973798445351168705571338038242156844331489594410388042023640557682239466962897137572560263842700783602548079538411269917951709343751682463926465588103389687629, 10529326968093239543950099930220718075013467617149636917837150891733058446542057036697390587553168008907983082761376475539557611711105684177864549007648328356927373144421152520897906224124516014288575960915684270833951930317576205914518570586629652639155120255307071810133639871721179689165441241113202165428601629487087661272021078970929708854946476537993370747987461812312887008729935221001850264842676955588774865856149460591670935611536425620896493129015493455941404968836530703749249322061603047664086363342243757507722298953020299966298909365549021744568238682989694883381328719058475658842521707672975413960837, 10529326968093239543950099930220718075013467617149636917837150891733058446542057036697390587553168008907983082761376475539557611711105684177864549007648328356927373144421152520897906224124516014288575960915684270833951930317576205914518570586629652639155120255307071810133639871721179689165441241113202165428601629487087661272021078970929708854946476537993370747987461812312887008729935221001850264842676955588774865856149460591670935611536425620896493129015493455941404968836530703749249322061603047664086363342243757507722298953020299966298909365549021744568238682989694883381328719058475658842521707672975413960837, 18013040217357763369221488177399796305572696273653161200442717112923151849145801331730851580078975476272460713453798926482089913569321579393489934807129553192601081620578767530669375056180418635861646653331191540010091341260423544325575074122517372297293462368153709380785233381667142703484913056769432341880972742827048478612132854187978446890975038578448737797793715819371534996707028040375781072704059734321769208565431136803251073429840998234439970504606853531974747644013964305008386599682226360264310599067089244359127966551083310379367322851818472683774851911603267421433759873027711598807817529974585847058169, 13000933961974079662465685825943783927831537259487952009592525317190159276770972048085063757920054330804408650061428491868583383648859489319726946799006236111926537628980626312633703242159346171006437132039912667509346834493222570224187981626140799716836803189688617361974592343716150959997327755881913998235641035357580643668157297104573957978921754633681583176462163860678874680788870177434358803927527631623339081727549294875090585645868729067422560778893790411432082383333861929800698981936916689049895990982788634304321786840301142154304800042781077310434745914530008676815975524297256243505951272057516667866023, 17165271319874592353776117274400898334459202668488237238746496950245192460859821949706959194150855021191192078350528874914673800986992912982377693158623338615602762217669459658655019046267029739463086937848369506202015764726642228039310758974474484581036641026129850461844641894908684519961136571806516397480625885428342333414844969821236267301091321148938831524185970688146965802160373361825783164768826226673520098070751908835835144256997842310569636753326582131384479448743218867852698478984933196148257216485682210634511126874153026125924016391710852937553128156164152172862864476742362317713243669784832881859083, 10529326968093239543950099930220718075013467617149636917837150891733058446542057036697390587553168008907983082761376475539557611711105684177864549007648328356927373144421152520897906224124516014288575960915684270833951930317576205914518570586629652639155120255307071810133639871721179689165441241113202165428601629487087661272021078970929708854946476537993370747987461812312887008729935221001850264842676955588774865856149460591670935611536425620896493129015493455941404968836530703749249322061603047664086363342243757507722298953020299966298909365549021744568238682989694883381328719058475658842521707672975413960837, 9589147282168140796685443350375588599947321654918139072371425160465035058042413474673876646067892434950613663440104577331983748102165740912718585736269986977684160970301815028112388614736742312588011751583388484092798667992083601948753222183140863423175556523946442972958231495911333312204430948631674718456476409544542167652844336052204775636099657783185560295207391483752588789115899567569127210679068843169108115187996315894332509324723582991227559576864405596683169052211645804711420209099040452099322873612502887642882592060656699781857176984566468779370661245953038535490863856768029282384610255796753663324229, 10529326968093239543950099930220718075013467617149636917837150891733058446542057036697390587553168008907983082761376475539557611711105684177864549007648328356927373144421152520897906224124516014288575960915684270833951930317576205914518570586629652639155120255307071810133639871721179689165441241113202165428601629487087661272021078970929708854946476537993370747987461812312887008729935221001850264842676955588774865856149460591670935611536425620896493129015493455941404968836530703749249322061603047664086363342243757507722298953020299966298909365549021744568238682989694883381328719058475658842521707672975413960837, 2792824974795279736050779673246486868103742467669877986946317952208588227583458154501920094167129329186679713799038875908210733279041350665359395079209754064021940615225818143442368859256767244004905139744808639051277151679343811430041359509857243475851261297220271635374619903558301031418644429230654283537438175978116580691521831537948005689487349729535814082639386964055597917600913283821621831529958403348584918295759803344139062078264742596665829089412257004147411103168932529012846518403436933105608201810081243657741436637094152581479058599986743516933639538957576144321807028724090703475438659550584899716596, 6025036497841766620535887029858501975915507957654258339226049699574076736672322598131587051280721553761897968096962471515247959483223675682092517552645584677140667995867205119738246419977978514367103295668714378962739013278485159529704387437363660550860426551311211668444602623929175587540301823417416159609898572262864980564467841841284122547155598269471374001966689231219273310232403955259208975367278143221878191141168648515801725062846825184942783962647876081708531505101690844930552670833286536247700990472074087507818758429427170725070452476998424223771635540737939376238562776261650668390641918344760866327201, 7322575685498501056742687625090783777176224534590526126754043908572095185076188048217398583683950730623240774867141663647628225249625571022983597858259469122084701555740561480180690124135768848881830279651080907801627389611956799612688974247865203233427340331654466714472277745354496570225316736180847037754465946363651512609540830067557973585184658851036809637461568269966864906029568476373205847591837047728610909883773582057449282013846672503149522625453363100872283831809486637180570148102395646482267996993219143711285162727046332823468018625438243199030081913895671864265100611736871261223272906001043924178814, 3242054483116803699329144034722026598436320364946167331034523339158798692771473745838289029777829822657533110889672254212886075544141108014090242623615826265708758661459821845788208832977484982485235696433997070110665922574988244039641764770366937763426206855535555769616858610061860560263642782074849544265609721154757029893917215502990088263565167914111608968698262239389951254859871940628846420567140713709246350288565539035306748964548947707530078292247155516270739762704053472664737258494910327901146658523258364721747421228227062961499349270382543999760388185218234610297353019607079252432039942370583759554335, 12218583538503113657034098973571855732461960329702749965297304654734222504510394806579828882412314873153701987586609282587147128982721673321650949261444663564821618660293978266488635205372076827444131626156413302660067380166241765284079965511730525454361498279843583524355166585280022235284329611504962946991212589194534131402840476462837463767910514344957480070023452543690102438509917195575781013107968061518530975223731588027250874278013586832963094479773202983826013947759160386297161693293561062410383403237936997367392850761225807694256384646785581937791673911045651714027051227597631797564749630634988931090295, 7322575685498501056742687625090783777176224534590526126754043908572095185076188048217398583683950730623240774867141663647628225249625571022983597858259469122084701555740561480180690124135768848881830279651080907801627389611956799612688974247865203233427340331654466714472277745354496570225316736180847037754465946363651512609540830067557973585184658851036809637461568269966864906029568476373205847591837047728610909883773582057449282013846672503149522625453363100872283831809486637180570148102395646482267996993219143711285162727046332823468018625438243199030081913895671864265100611736871261223272906001043924178814, 3242054483116803699329144034722026598436320364946167331034523339158798692771473745838289029777829822657533110889672254212886075544141108014090242623615826265708758661459821845788208832977484982485235696433997070110665922574988244039641764770366937763426206855535555769616858610061860560263642782074849544265609721154757029893917215502990088263565167914111608968698262239389951254859871940628846420567140713709246350288565539035306748964548947707530078292247155516270739762704053472664737258494910327901146658523258364721747421228227062961499349270382543999760388185218234610297353019607079252432039942370583759554335, 18013040217357763369221488177399796305572696273653161200442717112923151849145801331730851580078975476272460713453798926482089913569321579393489934807129553192601081620578767530669375056180418635861646653331191540010091341260423544325575074122517372297293462368153709380785233381667142703484913056769432341880972742827048478612132854187978446890975038578448737797793715819371534996707028040375781072704059734321769208565431136803251073429840998234439970504606853531974747644013964305008386599682226360264310599067089244359127966551083310379367322851818472683774851911603267421433759873027711598807817529974585847058169, 7322575685498501056742687625090783777176224534590526126754043908572095185076188048217398583683950730623240774867141663647628225249625571022983597858259469122084701555740561480180690124135768848881830279651080907801627389611956799612688974247865203233427340331654466714472277745354496570225316736180847037754465946363651512609540830067557973585184658851036809637461568269966864906029568476373205847591837047728610909883773582057449282013846672503149522625453363100872283831809486637180570148102395646482267996993219143711285162727046332823468018625438243199030081913895671864265100611736871261223272906001043924178814, 7366399579574602440976732407505552370818088489041276411824284406675583668949023906514737576787809482570376589120972541108132007260671334754841428677974325066771837379251553176747428530042619071429669631786581226509847881367573647725600753246915695486683228343013323745796657528897714064997694881169287854865595040353389336793597555449161182601340636166940834435839773757007527549181296092215237935351837824719175322474660191854493616190856482616197580756633363279022419897550310233268165094874340189901815352270117575288724707603063010230083024137461593412614562033025568083772205732033334034140833948551426221702933, 4703871041660600240688970243340830190915665849517002250164762459352118404257330371144012659662142918458224491058895727536730535430070582897465976655609475274898679197784075046635155061624045310839629208823848275617741928707874968567272418762902222441180871198933320386070422633931098072496768014418809006719419394475464990501284897814232897752132283546359452376490419566002200461542831518882381918490638128531427564081238746670843040931663124416084515631668028607511715921774562344230875868836572835594795246385623345552093667582463733264769343567278780373315708221664857541446769209506615511498638788895140903495342, 9589147282168140796685443350375588599947321654918139072371425160465035058042413474673876646067892434950613663440104577331983748102165740912718585736269986977684160970301815028112388614736742312588011751583388484092798667992083601948753222183140863423175556523946442972958231495911333312204430948631674718456476409544542167652844336052204775636099657783185560295207391483752588789115899567569127210679068843169108115187996315894332509324723582991227559576864405596683169052211645804711420209099040452099322873612502887642882592060656699781857176984566468779370661245953038535490863856768029282384610255796753663324229, 6025036497841766620535887029858501975915507957654258339226049699574076736672322598131587051280721553761897968096962471515247959483223675682092517552645584677140667995867205119738246419977978514367103295668714378962739013278485159529704387437363660550860426551311211668444602623929175587540301823417416159609898572262864980564467841841284122547155598269471374001966689231219273310232403955259208975367278143221878191141168648515801725062846825184942783962647876081708531505101690844930552670833286536247700990472074087507818758429427170725070452476998424223771635540737939376238562776261650668390641918344760866327201, 10529326968093239543950099930220718075013467617149636917837150891733058446542057036697390587553168008907983082761376475539557611711105684177864549007648328356927373144421152520897906224124516014288575960915684270833951930317576205914518570586629652639155120255307071810133639871721179689165441241113202165428601629487087661272021078970929708854946476537993370747987461812312887008729935221001850264842676955588774865856149460591670935611536425620896493129015493455941404968836530703749249322061603047664086363342243757507722298953020299966298909365549021744568238682989694883381328719058475658842521707672975413960837, 2969104952225441248961464312723202200179588680598690050380165913886988358426369492263068161863612948492620553523502907779221447008597559347293668289744869701695121761652372298324986153918392789470221725886212517283502414585782455978265556321861920972185829223550145296379683536030081162745110670578234854816529208986655357403182439810947962973674537010392137726530108088226705580276910806923436905058715116360700582978044321037563704193539038671782519101430563739424102156724283704178962791607461055215309634939008056400836638537070208912325876364293535546921566373911472085005179566861730414716227813123256632276035, 13000933961974079662465685825943783927831537259487952009592525317190159276770972048085063757920054330804408650061428491868583383648859489319726946799006236111926537628980626312633703242159346171006437132039912667509346834493222570224187981626140799716836803189688617361974592343716150959997327755881913998235641035357580643668157297104573957978921754633681583176462163860678874680788870177434358803927527631623339081727549294875090585645868729067422560778893790411432082383333861929800698981936916689049895990982788634304321786840301142154304800042781077310434745914530008676815975524297256243505951272057516667866023, 5849842760584556865845444342914777263831841815210315746533614811980779531315726861430924496083900295294276378327935339678447042695861714126568883971584247657203804855204950264185486098092009885339087418308130581461698671384349720033016954369264713784314782698300076406523682359688357697771680357904121266704221208805065278162931745946167034316714191113062308161373256230142247753808200314501997598945880457875890471716702970125488982165900241010205676743934722758581187890059931058950683775384251120532438708138469205827189534285522098123921400273531374578729642973124148088923920036513126193405209639380706481622073]
```
```
def find_exponent(c, m, n, e_min=500, e_max=1000):
    for e in range(e_min, e_max + 1):
        if pow(m, e, n) == c:
            return e
    return None

def find_base(c, e, n, m_min=0, m_max=1000000):
    for m in range(m_min, m_max + 1):
        if pow(m, e, n) == c:
            return m
    return None

flags = []
for i in m:
        flag = find_base(i,e,n)
        flag = chr(flag)
        flags.append(flag)
flags = ''.join(flags)
print(flags)
```
# Flag
flag{29070b0688f398587d41041f4b25d8a3}
